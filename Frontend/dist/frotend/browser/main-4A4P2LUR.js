import{a as B}from"./chunk-RLNHWRDG.js";import{a as p}from"./chunk-U6BUASLA.js";import{B as a,Ba as x,Ca as c,Da as U,Ea as G,F as g,Fa as D,G as b,Ga as N,K as u,N as w,O as s,P as o,Q as i,R as d,T as M,U as v,Y as m,Z as C,_ as k,f as A,i as _,ia as L,ja as H,ka as E,q as l,qa as O,ra as j,sa as R,t as f,u as I,ua as V,va as T,wa as z,ya as F,za as P}from"./chunk-AOLGXRAL.js";var $=(e,r)=>{let t=l(p),n=l(c);return t.isAuthenticated?!0:(n.navigate(["/auth/login"],{queryParams:{returnUrl:r.url}}),!1)};var Z=()=>{let e=l(p),r=l(c);return e.isAuthenticated?(r.navigate(["/dashboard"]),!1):!0};function q(e,r){if(e&1&&(o(0,"div",21)(1,"h1",22),m(2,"EstancoPro"),i(),o(3,"p",23),m(4),i()()),e&2){let t=v();a(4),C(t.currentUser==null?null:t.currentUser.roleName)}}function ee(e,r){if(e&1&&(o(0,"div",24)(1,"p",25),m(2,"Caja Abierta"),i(),o(3,"p",26),m(4),L(5,"number"),i()()),e&2){let t=v();a(4),k("$",H(5,1,t.currentSession.openingAmount,"1.0-0"))}}function te(e,r){e&1&&(o(0,"div",27)(1,"p",28),m(2,"Sin caja abierta"),i()())}function re(e,r){if(e&1&&(o(0,"span",33),m(1),i()),e&2){let t=v().$implicit;a(),C(t.label)}}function ne(e,r){if(e&1&&(o(0,"a",29),f(),o(1,"svg",30),d(2,"path",31),i(),u(3,re,2,1,"span",32),i()),e&2){let t=r.$implicit,n=v();s("routerLink",t.route)("ngClass",n.sidebarOpen?"justify-start":"justify-center"),a(2),w("d",t.iconSvg),a(),s("ngIf",n.sidebarOpen)}}function oe(e,r){if(e&1&&(o(0,"div",34)(1,"p",35),m(2),i()()),e&2){let t=v();a(2),C(t.currentUser==null?null:t.currentUser.email)}}function ie(e,r){e&1&&(o(0,"span",36),m(1,"Salir"),i())}var S=class e{constructor(r,t,n){this.authService=r;this.cashService=t;this.router=n}currentUser=null;currentSession=null;sidebarOpen=!0;menuItems=[{label:"Dashboard",iconSvg:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6",route:"/dashboard",roles:["Administrador","Cajero","Vendedor","Inventario","Gerente"]},{label:"Punto de Venta",iconSvg:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z",route:"/pos",roles:["Administrador","Cajero","Vendedor"]},{label:"Productos",iconSvg:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",route:"/products",roles:["Administrador","Inventario","Gerente"]},{label:"Categor\xEDas",iconSvg:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",route:"/categories",roles:["Administrador","Inventario"]},{label:"Compras",iconSvg:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z",route:"/purchases",roles:["Administrador","Inventario","Gerente"]},{label:"Proveedores",iconSvg:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4",route:"/suppliers",roles:["Administrador","Inventario"]},{label:"Caja",iconSvg:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z",route:"/cash",roles:["Administrador","Cajero","Gerente"]},{label:"Clientes",iconSvg:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z",route:"/customers",roles:["Administrador","Cajero","Vendedor","Gerente"]},{label:"Reportes",iconSvg:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",route:"/reports",roles:["Administrador","Gerente"]},{label:"Usuarios",iconSvg:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z",route:"/admin/users",roles:["Administrador"]},{label:"Configuraci\xF3n",iconSvg:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z",route:"/admin/settings",roles:["Administrador"]}];ngOnInit(){this.currentUser=this.authService.currentUserValue,this.cashService.currentSession$.subscribe(r=>{this.currentSession=r})}get visibleMenuItems(){return this.currentUser?this.menuItems.filter(r=>r.roles.includes(this.currentUser.roleName)):[]}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}logout(){this.authService.logout()}isActive(r){return this.router.url===r}static \u0275fac=function(t){return new(t||e)(g(p),g(B),g(c))};static \u0275cmp=b({type:e,selectors:[["app-layout"]],decls:23,vars:10,consts:[[1,"flex","h-screen","bg-bg-green"],[1,"transition-all","duration-300","ease-in-out",3,"ngClass"],[1,"h-full","flex","flex-col","bg-gradient-to-b","from-estanco","to-estanco-dark","shadow-green-lg"],[1,"p-4","border-b","border-estanco-lighter"],[1,"flex","items-center",3,"ngClass"],[1,"text-3xl"],["class","ml-3",4,"ngIf"],["class","px-4 py-3 bg-success-bg border-l-4 border-success m-2 rounded",4,"ngIf"],["class","px-4 py-3 bg-warning-bg border-l-4 border-warning m-2 rounded",4,"ngIf"],[1,"flex-1","overflow-y-auto","py-4"],["routerLinkActive","bg-estanco-light border-l-4 border-lime","class","flex items-center px-4 py-3 text-mint hover:bg-estanco-light hover:text-white transition-all duration-200 cursor-pointer",3,"routerLink","ngClass",4,"ngFor","ngForOf"],[1,"border-t","border-estanco-lighter","p-4"],["class","mb-3",4,"ngIf"],[1,"w-full","flex","items-center","justify-center","px-4","py-2","bg-error","hover:bg-red-700","text-white","rounded-md","transition-colors","duration-200",3,"click","ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],["class","ml-2",4,"ngIf"],[1,"absolute","top-20","-right-3","bg-lime","hover:bg-lime-light","text-white","rounded-full","p-2","shadow-lg","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","transition-transform","duration-200",3,"ngClass"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"flex-1","overflow-y-auto"],[1,"ml-3"],[1,"text-white","font-bold","text-lg"],[1,"text-mint","text-xs"],[1,"px-4","py-3","bg-success-bg","border-l-4","border-success","m-2","rounded"],[1,"text-xs","font-semibold","text-green-800"],[1,"text-xs","text-green-700"],[1,"px-4","py-3","bg-warning-bg","border-l-4","border-warning","m-2","rounded"],[1,"text-xs","font-semibold","text-yellow-800"],["routerLinkActive","bg-estanco-light border-l-4 border-lime",1,"flex","items-center","px-4","py-3","text-mint","hover:bg-estanco-light","hover:text-white","transition-all","duration-200","cursor-pointer",3,"routerLink","ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["class","ml-3 font-medium",4,"ngIf"],[1,"ml-3","font-medium"],[1,"mb-3"],[1,"text-white","text-sm","font-medium","truncate"],[1,"ml-2"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"aside",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),m(6,"\u{1F3EA}"),i(),u(7,q,5,1,"div",6),i()(),u(8,ee,6,4,"div",7)(9,te,3,0,"div",8),o(10,"nav",9),u(11,ne,4,4,"a",10),i(),o(12,"div",11),u(13,oe,3,1,"div",12),o(14,"button",13),M("click",function(){return n.logout()}),f(),o(15,"svg",14),d(16,"path",15),i(),u(17,ie,2,0,"span",16),i()(),I(),o(18,"button",17),M("click",function(){return n.toggleSidebar()}),f(),o(19,"svg",18),d(20,"path",19),i()()()(),I(),o(21,"main",20),d(22,"router-outlet"),i()()),t&2&&(a(),s("ngClass",n.sidebarOpen?"w-64":"w-20"),a(3),s("ngClass",n.sidebarOpen?"justify-start":"justify-center"),a(3),s("ngIf",n.sidebarOpen),a(),s("ngIf",n.currentSession&&n.sidebarOpen),a(),s("ngIf",!n.currentSession&&n.sidebarOpen),a(2),s("ngForOf",n.visibleMenuItems),a(2),s("ngIf",n.sidebarOpen),a(),s("ngClass",n.sidebarOpen?"":"text-xs"),a(3),s("ngIf",n.sidebarOpen),a(2),s("ngClass",n.sidebarOpen?"":"rotate-180"))},dependencies:[T,O,j,R,N,x,U,G,V],styles:["[_nghost-%COMP%]{display:block;height:100%}aside[_ngcontent-%COMP%]{position:relative}"]})};var J=[{path:"auth/login",canActivate:[Z],loadComponent:()=>import("./chunk-QNQZTVD2.js").then(e=>e.LoginComponent)},{path:"",component:S,canActivate:[$],children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>import("./chunk-NNV4VPMK.js").then(e=>e.DashboardComponent)},{path:"pos",loadComponent:()=>import("./chunk-7LOSE7UD.js").then(e=>e.PosComponent)},{path:"products",loadComponent:()=>import("./chunk-6CNMD2LS.js").then(e=>e.ProductsComponent)},{path:"cash",loadComponent:()=>import("./chunk-6M7KEEZA.js").then(e=>e.CashComponent)}]},{path:"**",redirectTo:""}];var K=(e,r)=>{let n=l(p).getAuthToken();return n&&e.url.includes("/api/")&&(e=e.clone({setHeaders:{Authorization:`Bearer ${n}`}})),r(e)};var Q=(e,r)=>{let t=l(c),n=l(p);return r(e).pipe(_(h=>(h.status===401&&(n.logout(),t.navigate(["/auth/login"],{queryParams:{returnUrl:t.url}})),A(()=>h))))};var W={providers:[E({eventCoalescing:!0}),D(J),F(P([K,Q]))]};var y=class e{title="EstancoPro";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){t&1&&d(0,"router-outlet")},dependencies:[x],encapsulation:2})};z(y,W).catch(e=>console.error(e));
