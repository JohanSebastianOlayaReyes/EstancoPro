import{a as E}from"./chunk-U6BUASLA.js";import{b as y,c as u,d as F,e as I,g as L,i as M,j as N,o as T,q as A}from"./chunk-VMEROYEQ.js";import{Aa as S,B as a,Ca as w,F as d,G as v,K as m,O as s,P as i,Q as n,R as p,T as h,U as c,Y as l,_ as b,ea as f,qa as _,sa as x,t as g,va as C}from"./chunk-AOLGXRAL.js";var j=e=>({"input-error":e});function D(e,o){if(e&1&&(i(0,"div",22),g(),i(1,"svg",23),p(2,"path",24),n(),l(3),n()),e&2){let r=c();a(3),b(" ",r.errorMessage," ")}}function G(e,o){e&1&&(i(0,"span"),l(1,"El email es requerido"),n())}function R(e,o){e&1&&(i(0,"span"),l(1,"Email inv\xE1lido"),n())}function V(e,o){if(e&1&&(i(0,"div",25),m(1,G,2,0,"span",16)(2,R,2,0,"span",16),n()),e&2){let r=c();a(),s("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.required),a(),s("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.email)}}function B(e,o){e&1&&(i(0,"span"),l(1,"La contrase\xF1a es requerida"),n())}function z(e,o){e&1&&(i(0,"span"),l(1,"M\xEDnimo 6 caracteres"),n())}function P(e,o){if(e&1&&(i(0,"div",25),m(1,B,2,0,"span",16)(2,z,2,0,"span",16),n()),e&2){let r=c();a(),s("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.required),a(),s("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.minlength)}}function U(e,o){e&1&&(i(0,"span"),l(1,"Iniciar Sesi\xF3n"),n())}function O(e,o){e&1&&(i(0,"span",26),g(),i(1,"svg",27),p(2,"circle",28)(3,"path",29),n(),l(4," Iniciando sesi\xF3n... "),n())}var k=class e{constructor(o,r,t,q){this.fb=o;this.authService=r;this.router=t;this.route=q;this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]]}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/dashboard"}loginForm;loading=!1;errorMessage="";returnUrl="/dashboard";get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}onSubmit(){if(this.loginForm.invalid){Object.keys(this.loginForm.controls).forEach(o=>{this.loginForm.get(o)?.markAsTouched()});return}this.loading=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:o=>{console.log("Login exitoso:",o),this.router.navigate([this.returnUrl])},error:o=>{console.error("Error en login:",o),this.loading=!1,o.status===401?this.errorMessage="Email o contrase\xF1a incorrectos":o.status===0?this.errorMessage="No se puede conectar al servidor. Verifica que el backend est\xE9 corriendo.":this.errorMessage=o.error?.message||"Error al iniciar sesi\xF3n. Intenta nuevamente."}})}static \u0275fac=function(r){return new(r||e)(d(T),d(E),d(w),d(S))};static \u0275cmp=v({type:e,selectors:[["app-login"]],decls:36,vars:15,consts:[[1,"min-h-screen","bg-bg-green","flex","items-center","justify-center","p-4"],[1,"bg-white","rounded-lg","shadow-green-lg","p-8","w-full","max-w-md"],[1,"text-center","mb-8"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-estanco","rounded-full","mb-4"],[1,"text-3xl"],[1,"text-2xl","font-bold","text-estanco-dark"],[1,"text-gray-600","text-sm","mt-2"],["class","alert-error mb-4",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"label"],["type","email","formControlName","email","placeholder","admin@gmail.com",1,"input",3,"ngClass","disabled"],["class","text-error text-sm mt-1",4,"ngIf"],[1,"mb-6"],["type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input",3,"ngClass","disabled"],["type","submit",1,"btn-primary","w-full",3,"disabled"],[4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],[1,"mt-6","p-4","bg-bg-green","rounded-md","border","border-border-green"],[1,"text-xs","font-semibold","text-estanco-dark","mb-2"],[1,"text-xs","text-gray-600"],[1,"font-mono"],[1,"alert-error","mb-4"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","inline","mr-2"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-error","text-sm","mt-1"],[1,"flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","mr-2"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),l(5,"\u{1F3EA}"),n()(),i(6,"h1",5),l(7,"EstancoPro"),n(),i(8,"p",6),l(9,"Ingresa tus credenciales para continuar"),n()(),m(10,D,4,1,"div",7),i(11,"form",8),h("ngSubmit",function(){return t.onSubmit()}),i(12,"div",9)(13,"label",10),l(14,"Email"),n(),p(15,"input",11),m(16,V,3,2,"div",12),n(),i(17,"div",13)(18,"label",10),l(19,"Contrase\xF1a"),n(),p(20,"input",14),m(21,P,3,2,"div",12),n(),i(22,"button",15),m(23,U,2,0,"span",16)(24,O,5,0,"span",17),n()(),i(25,"div",18)(26,"p",19),l(27,"Credenciales de prueba:"),n(),i(28,"p",20),l(29,"Email: "),i(30,"span",21),l(31,"admin@gmail.com"),n()(),i(32,"p",20),l(33,"Contrase\xF1a: "),i(34,"span",21),l(35,"Admin123*"),n()()()()()),r&2&&(a(10),s("ngIf",t.errorMessage),a(),s("formGroup",t.loginForm),a(4),s("ngClass",f(11,j,(t.email==null?null:t.email.invalid)&&(t.email==null?null:t.email.touched)))("disabled",t.loading),a(),s("ngIf",(t.email==null?null:t.email.invalid)&&(t.email==null?null:t.email.touched)),a(4),s("ngClass",f(13,j,(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)))("disabled",t.loading),a(),s("ngIf",(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)),a(),s("disabled",t.loading),a(),s("ngIf",!t.loading),a(),s("ngIf",t.loading))},dependencies:[C,_,x,A,L,y,F,I,M,N],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};export{k as LoginComponent};
