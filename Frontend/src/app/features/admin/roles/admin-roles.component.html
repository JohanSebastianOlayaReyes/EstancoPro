<div class="admin-container">
  <app-sidebar-menu [sections]="menuSections"></app-sidebar-menu>
  <div class="admin-content">
    <app-estanco-card>
      <div class="section-header">
        <h2>
          <app-icon name="clipboard-list" [size]="24" />
          Roles del Sistema
        </h2>
        <app-button variant="primary" size="sm" (clicked)="showCreateRolForm()">
          <app-icon name="plus" [size]="18" />
          Crear Rol
        </app-button>
      </div>

      <div class="roles-list">
        <div *ngIf="errorMessage()" class="alert error">{{ errorMessage() }}</div>
        <div *ngIf="successMessage()" class="alert success">{{ successMessage() }}</div>

        <div class="roles-grid">
          <div *ngFor="let r of roles()" class="role-item">
            <div class="role-main">
              <strong>{{ r.typeRol }}</strong>
              <p class="desc">{{ r.description }}</p>
            </div>
            <div class="role-actions">
              <app-button size="sm" variant="ghost" (clicked)="editRol(r)">Editar</app-button>
              <app-button size="sm" variant="destructive" (clicked)="deleteRol(r.id!)">Eliminar</app-button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal form for create/edit rol -->
      <div *ngIf="showRolForm()" class="modal-overlay">
        <div class="modal-backdrop" (click)="cancelRolForm()"></div>
        <div class="modal-window">
          <div class="modal-header">
            <h3>{{ editingRol() ? 'Editar Rol' : 'Crear Rol' }}</h3>
            <app-button variant="ghost" (clicked)="cancelRolForm()">Cerrar</app-button>
          </div>
          <form (submit)="saveRol($event)" class="compact-form">
            <app-input id="typeRol" label="Nombre del Rol" [value]="rolForm().typeRol" (valueChange)="updateRolField('typeRol', $any($event))" [required]="true"></app-input>
            <app-input id="description" label="DescripciÃ³n" [value]="rolForm().description" (valueChange)="updateRolField('description', $any($event))"></app-input>
            <div class="form-row">
              <label>
                <input type="checkbox" [checked]="rolForm().active" (change)="toggleActive($event)" /> Activo
              </label>
            </div>
            <div class="form-actions">
              <app-button type="button" variant="ghost" (clicked)="cancelRolForm()">Cancelar</app-button>
              <app-button type="submit" variant="primary" [loading]="loadingRol()">{{ editingRol() ? 'Guardar' : 'Crear' }}</app-button>
            </div>
          </form>
        </div>
      </div>
    </app-estanco-card>
  </div>
</div>
